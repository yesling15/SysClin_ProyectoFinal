@model SysClin.Models.ViewModel.UsuarioPerfilViewModel

@{
    ViewBag.Title = "Mi perfil";
    Layout = ViewBag.Layout;
}

<h2>Mi perfil</h2>
<hr />

@using (Html.BeginForm("EditarPerfil", "Usuario", FormMethod.Post, new { role = "form" }))
{
    @Html.AntiForgeryToken()
    @Html.HiddenFor(m => m.ID_Usuario)

    @Html.ValidationSummary(true, "", new { @class = "text-danger mb-3" })

    <div class="card shadow-sm">
        <div class="card-body">
            <div class="row">

                <!-- Columna izquierda -->
                <div class="col-md-6">

                    <!-- Tipo de usuario -->
                    @Html.Label("Tipo de usuario")
                    <input type="text" class="form-control" value="@Model.TipoUsuarioNombre" disabled />

                    <!-- Tipo de identificación -->
                    @Html.Label("Tipo de identificación", null, new { @class = "mt-3" })
                    <input type="text" class="form-control" value="@Model.TipoIdentificacionNombre" disabled />

                    <!-- Número de identificación -->
                    @Html.Label("Número de identificación", null, new { @class = "mt-3" })
                    <input type="text" class="form-control" value="@Model.Numero_Identificacion" disabled />

                    <!-- Nombre -->
                    @Html.LabelFor(m => m.Nombre, new { @class = "mt-3" })
                    @Html.TextBoxFor(m => m.Nombre, new { @class = "form-control" })
                    @Html.ValidationMessageFor(m => m.Nombre, "", new { @class = "d-block text-danger mb-2" })

                    <!-- Primer apellido -->
                    @Html.LabelFor(m => m.Primer_Apellido)
                    @Html.TextBoxFor(m => m.Primer_Apellido, new { @class = "form-control" })
                    @Html.ValidationMessageFor(m => m.Primer_Apellido, "", new { @class = "d-block text-danger mb-2" })

                    <!-- Segundo apellido -->
                    @Html.LabelFor(m => m.Segundo_Apellido)
                    @Html.TextBoxFor(m => m.Segundo_Apellido, new { @class = "form-control" })
                    @Html.ValidationMessageFor(m => m.Segundo_Apellido, "", new { @class = "d-block text-danger mb-2" })
                </div>

                <!-- Columna derecha -->
                <div class="col-md-6">

                    <!-- Fecha de nacimiento -->
                    @Html.LabelFor(m => m.Fecha_Nacimiento)
                    @Html.TextBoxFor(m => m.Fecha_Nacimiento, "{0:yyyy-MM-dd}", new { @class = "form-control", type = "date" })

                    @Html.ValidationMessageFor(m => m.Fecha_Nacimiento, "", new { @class = "d-block text-danger mb-2" })

                    <!-- Correo -->
                    @Html.LabelFor(m => m.Correo_Electronico)
                    @Html.TextBoxFor(m => m.Correo_Electronico, new { @class = "form-control", type = "email" })
                    @Html.ValidationMessageFor(m => m.Correo_Electronico, "", new { @class = "d-block text-danger mb-2" })

                    <!-- Teléfono -->
                    @Html.LabelFor(m => m.Telefono)
                    @Html.TextBoxFor(m => m.Telefono, new { @class = "form-control" })
                    @Html.ValidationMessageFor(m => m.Telefono, "", new { @class = "d-block text-danger mb-2" })

                    <div class="mt-4">
                        <button type="submit" class="btn btn-primary me-2">Guardar cambios</button>
                        <button type="button" class="btn btn-outline-secondary"
                                onclick="location.href='@Url.Action("Index", "Home")'">
                            Cancelar
                        </button>
                    </div>

                </div>
            </div>
        </div>
    </div>
}

@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")

    <!-- SweetAlert -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    @if (ViewBag.EditarPerfilExitoso != null && (bool)ViewBag.EditarPerfilExitoso)
    {
        <script>
        Swal.fire({
            icon: 'success',
            title: 'Perfil actualizado',
            text: 'La información se ha guardado correctamente.'
        }).then(function () {
            window.location.href = '@Url.Action("Index", "Home")';
        });
        </script>
    }
}
